<!DOCTYPE html>
<html><head><meta charset="utf-8" /><meta content="IE=edge;chrome=1" http-equiv="X-UA-Compatible" /><meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport" /><link href="/images/favicon.ico?1517672140" rel="icon" type="image/ico" /><link href="http://blog.glebm.com/feed.xml" rel="alternate" title="Gleb's Notes Feed" type="application/atom+xml" /><title>Database-agnostic case-insensitive equality, full text search on Gleb's Notes</title><link href="/stylesheets/application.css?1517672140" rel="stylesheet" /><link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet" />
</head><body><script type="text/javascript">      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-43451052-1', 'blog.glebm.com');
      ga('send', 'pageview');
</script><header class="navbar navbar-dark bg-primary"><nav class="container"><div class="navbar-brand"><a href="/">Gleb's Notes</a></div><ul class="navbar-nav mr-auto"><li class="nav-item"><a href="/" class="nav-link">Index</a></li></ul></nav></header><div class="container"><div class="row"><div class="col-md-9 col-lg-9"><div class=" " id="main" role="main"><div class="article"><div class="article-header"><h1 class="article-title"><a href="http://blog.glebm.com/2016/03/31/db-text-search.html">Database-agnostic case-insensitive equality, full text search</a></h1><div class="article-date"><span class='date'> <span class='day'>31</span> <span class='month'>Mar</span> <span class='year'> 2016 </span> </span></div></div><div class="article-body"><p>Different relational databases treat text search very differently.
The new <a href="https://github.com/thredded/db_text_search">DbTextSearch gem</a> provides a unified interface on top of ActiveRecord for SQLite, MySQL, and
PostgreSQL to do:</p>

<ul>
  <li>Case-insensitive string-in-set querying, and CI index creation.</li>
  <li>Basic full-text search for a list of terms, and FTS index creation.</li>
</ul>

<p><a href="https://github.com/thredded/db_text_search">DbTextSearch</a> does all the heavy lifting under the hood, hiding the complexity of handling each
database differently away, which is great for gem authors, when migrating an application from one database to another,
or writing code that must support multiple databases.</p>

<p></p>

<p>Here is how <a href="https://github.com/thredded/db_text_search">db_text_search</a> handles different types of columns in different databases for case-insensitive comparisons:</p>
<div class="table-responsive">
<table style="font-size: 16px; border: 0" class="table table-striped table-sm table-center-cells table-bordered">
<caption><a href="https://github.com/thredded/db_text_search">DbTextSearch</a> case-insensitive string matching methods</caption>
<thead>
  <tr><th style="vertical-align: bottom" rowspan="2">Column type</th><th colspan="2">SQLite</th><th colspan="2">MySQL</th><th colspan="2">PostgreSQL</th></tr>
  <tr><th>Detected types</th><th>Search / index</th><th>Detected types</th><th>Search / index</th><th>Detected types</th><th>Search / index</th></tr>
</thead>
<tbody style="text-align: center">
  <tr><th>Case-insensitive</th>
      <td rowspan="2">always treated as case-sensitive</td> <td rowspan="2"><code>COLLATE&nbsp;NOCASE</code></td>
      <td><i>default</i></td> <td><i>default</i></td>
      <td><code>CITEXT</code></td> <td><i>default</i></td>
  </tr>
  <tr><th>Case-sensitive</th>
    <td>non-<code>ci</code> collations</td> <td><code>LOWER</code><br /><b>no index</b></td>
    <td><i>default</i></td> <td><code>LOWER</code></td>
  </tr>
</tbody>
</table>
</div>
<p>Full-text search is even more gnarly. Great that you don't have to worry about that if you use this gem!
Check it out and learn more on <a href="https://github.com/thredded/db_text_search">github.com/thredded/db_text_search</a>.</p>

</div><div class="suggest-edit"><a class="btn btn-outline-primary btn-sm" href="https://github.com/glebm/blog-glebm-com/blob/master/source/2016-03-31-db-text-search.html.markdown.erb"><span class="fa fa-pencil fa-inline"></span>Suggest edit</a></div></div><div class="article-social"><h4>Share on</h4><ul><li><a class="social" href="https://twitter.com/share?text=Database-agnostic%20case-insensitive%20equality%2C%20full%20text%20search&url=http%3A%2F%2Fblog.glebm.com%2F2016%2F03%2F31%2Fdb-text-search.html" target="_blank"><i class='fa fa-twitter fa-inline'></i></a></li><li><a class="social" href="https://www.linkedin.com/cws/share?url=http%3A%2F%2Fblog.glebm.com%2F2016%2F03%2F31%2Fdb-text-search.html" target="_blank"><i class='fa fa-linkedin fa-inline'></i></a></li><li><a class="social" href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fblog.glebm.com%2F2016%2F03%2F31%2Fdb-text-search.html" target="_blank"><i class='fa fa-facebook fa-inline'></i></a></li><li><a class="social" href="https://plus.google.com/share?url=http%3A%2F%2Fblog.glebm.com%2F2016%2F03%2F31%2Fdb-text-search.html" target="_blank"><i class='fa fa-google-plus fa-inline'></i></a></li></ul></div><div class="comments">    <div id="disqus_thread"></div>
    <script type="text/javascript">
      var disqus_shortname = "blog-glebm";
var disqus_identifier = "db-text-search";
var disqus_title = "Database-agnostic case-insensitive equality, full text search";
var disqus_url = "http://blog.glebm.com/2016/03/31/db-text-search.html";
      (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div></div></div><div class="col-md-3"><aside class="sidebar"><div class="text-center"><div class="person-img"><img src='http://blog.glebm.com/images/author.jpg' class="img-fluid rounded-circle" width="883" height="883" alt="Author" /></div><p><abbr title="Gleb Mazovetskiy">@glebm</abbr></p><p><ul class="nav nav-fill nav-pills"><li class="nav-item"><a class="nav-link" href="https://twitter.com/glebm" rel="me"><i class='fa fa-twitter'></i> Twitter</a></li><li class="nav-item"><a class="nav-link" href="https://github.com/glebm" rel="me"><i class='fa fa-github'></i> Github</a></li></ul></p></div><hr /><h3>Posts</h3><ul class="nav nav-pills flex-column"><li class="nav-item"><a class="nav-link active" href="http://blog.glebm.com/2016/03/31/db-text-search.html">Database-agnostic case-insensitive equality, full text search</a></li><li class="nav-item"><a class="nav-link" href="http://blog.glebm.com/2014/02/27/i18n-made-easier-with-static-analysis.html">Internationalization made easier with static analysis</a></li><li class="nav-item"><a class="nav-link" href="http://blog.glebm.com/2013/08/31/redis-compressed-lists.html">Save Redis memory with large list packing</a></li><li class="nav-item"><a class="nav-link" href="http://blog.glebm.com/2013/08/28/inline-css-fonts.html">Inline CSS web fonts</a></li><li class="nav-item"><a class="nav-link" href="http://blog.glebm.com/2013/08/23/screenshots-in-git.html">Store screenshots of your web app in Git</a></li></ul><hr /><ul class="nav flex-column text-left"><li class="nav-item"><a class="nav-link" href="http://blog.glebm.com/feed.xml"><i class='fa fa-rss fa-fw'></i> Atom Feed</a></li><li class="nav-item"><a class="nav-link" href="https://github.com/glebm/blog-glebm-com"><i class='fa fa-code-fork fa-fw'></i> This blog on Github</a></li></ul><hr /><h3>Open Source</h3><div class="list-group"><a class="list-group-item list-group-item-action" href="https://thredded.org/"><h4 class="list-group-item-heading">Thredded</h4><p class="mb-1">Thredded is a Rails forum / messageboard engine.</p></a><a class="list-group-item list-group-item-action" href="https://github.com/glebm/i18n-tasks"><h4 class="list-group-item-heading">i118n-tasks</h4><p class="mb-1">Manage translation and localization with static analysis, for Ruby i18n.</p></a><a class="list-group-item list-group-item-action" href="https://github.com/glebm/order_query"><h4 class="list-group-item-heading">order_query</h4><p class="mb-1">ActiveRecord ORM extension to find next or previous records relative to the current one efficiently.</p></a></div></aside></div></div></div></body></html>